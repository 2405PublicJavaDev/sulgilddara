<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.makjan.sulgilddara.Reservation.model.Mapper.ReservationMapper">
 <resultMap type="Reservation" id="reserveResultMap">
 	<id property="reserveNo" column="RESERVE_NO"/>
 	<result property="userId" column="USERID"/>
 	<result property="memberNum" column="MEMBER_NUM"/>
 	<result property="reserveDate" column="RESERVE_DATE"/>
 	<result property="reserveTime" column="RESERVE_TIME"/>
 	<result property="tourId" column="TOURID"/>
 	<result property="emergencyPhone" column="EMERGENCY_PHONE"/>
 	<result property="breweryName" column="BREWERY_NAME"/>
 </resultMap>

 <insert id="RegisterInfo">
 INSERT INTO RESERVATION_TBL VALUES(#{reserveNo}, #{userId}, #{visitorNum}, #{reserveDate}, #{reserveTime}, 1, #{emergencyPhone},33)
 </insert>
 
 <select id="SearchInfo" resultMap="reserveResultMap">
 	SELECT * FROM RESERVATION_TBL WHERE RESERVE_NO=#{reserveNo}
 </select>
 
 <select id="SearchAllInfo" resultMap="reserveResultMap">
 	SELECT * FROM reservation_tbl
    <where>
        <if test="userId != null and userId != ''">
            AND USERID = #{userId}
        </if>
        <if test="breweryName != null and breweryName != ''">
            AND brewery_Name = #{breweryName}
        </if>
    </where>
</select>

 <select id="SearchreserveNo" resultMap="reserveResultMap">
 	SELECT RESERVE_NO FROM RESERVATION_TBL WHERE USERID=#{userId}
 </select>
 <select id="getTotalCount" resultType="_int">
 	SELECT COUNT(*) FROM reservation_tbl
    <where>
        <if test="userId != null and userId != ''">
            AND USERID = #{userId}
        </if>
        <if test="breweryName != null and breweryName != ''">
            AND brewery_Name = #{breweryName}
        </if>
    </where>
 </select>
 
 <select id="getTotalCountWithConditiion" resultType="_int">
 	SELECT COUNT(*) FROM reservation_tbl
    <where>
        <if test="userId != null and userId != ''">
            AND USERID = #{userId}
        </if>
        <if test="breweryName != null and breweryName != ''">
            AND brewery_Name = #{breweryName}
        </if>
    </where>
 </select>
 </mapper>